import zlib
import time
import threading
import sys
import logging
import datetime
import xml.etree.ElementTree as ET
from socket import *

#Server Info
HOST = "121.134.202.25"
PORT = 30001

#global variable
TransactionID = 0
SendAliveCheckTimer = 1
SHUTDOWN = False
lock = threading.Lock()
SessionID = ''

def GetTid():
    global TransactionID
    if TransactionID == 2147483647 :
        TransactionID = 0
    TransactionID = TransactionID + 1
    return TransactionID

def TcpSendMsg(SendMsg):
    compress_msg = zlib.compress(SendMsg.encode('utf-8'))
    header='WTRSTP/1.00000000000000%07d' % len(compress_msg)
    c.send(header.encode('utf-8') + compress_msg)
    logger.info('[SEND]' + SendMsg)

def SendEstablishSessionRequest():
    global lock
    lock.acquire()

    EstablishSessionRequest = '<?xml version="1.0"?>'
    EstablishSessionRequest += '<WTRS.MSG Version="1.0">'
    EstablishSessionRequest += '<HEADER From="urn:wtrsp:auth.endpoint:MMSC_ACPT" SessionID="" To="urn:wtrsp:system:wtrsg" TransactionID="%d">'  % (GetTid())
    EstablishSessionRequest += '<Error Code="" Description="" Source=""/>'
    EstablishSessionRequest += '</HEADER>'
    EstablishSessionRequest += '<BODY>'
    EstablishSessionRequest += '<EstablishSessionRequest>'
    EstablishSessionRequest += '<Endpoint ID="urn:wtrsp:auth.endpoint:MMSC_ACPT" IP="192.168.230.181" PWD="MMSC_DEV_TEST">'
    EstablishSessionRequest += '</Endpoint>'
    EstablishSessionRequest += '</EstablishSessionRequest>'
    EstablishSessionRequest += '</BODY>'
    EstablishSessionRequest += '</WTRS.MSG>'
    TcpSendMsg(EstablishSessionRequest)
    lock.release()

def SendCloseSessionRequest():
    global lock
    global SessionID
    lock.acquire()
    
    CloseSessionRequest = '<?xml version="1.0"?>'
    CloseSessionRequest += '<WTRS.MSG Version="1.0">'
    CloseSessionRequest += '<HEADER From="urn:wtrsp:auth.endpoint:MMSC_ACPT" SessionID="%s" To="urn:wtrsp:system:wtrsg" TransactionID="%d">' % (SessionID, GetTid())
    CloseSessionRequest += '<Error Code="" Description="" Source="" />'
    CloseSessionRequest += '</HEADER>'
    CloseSessionRequest += '<BODY>'
    CloseSessionRequest += '<CloseSessionRequest/>'
    CloseSessionRequest += '</BODY>'
    CloseSessionRequest += '</WTRS.MSG>' 
    
    TcpSendMsg(CloseSessionRequest)
    lock.release()

def SendCreateJobRequest():
    global lock
    global SessionID
    lock.acquire()
    
    CreateJobRequest = '<?xml version="1.0"?>'
    CreateJobRequest += '<WTRS.MSG Version="1.0">'
    CreateJobRequest += '<HEADER From="urn:wtrsp:auth.endpoint:MMSC_ACPT" SessionID="%s" To="urn:wtrsp:system:wtrsg" TransactionID="%d">' % (SessionID,GetTid())
    CreateJobRequest += '<Error Code="" Description="" Source=""/>'
    CreateJobRequest += '</HEADER>'
    CreateJobRequest += '<BODY>'
    CreateJobRequest += '<CreateJobRequest>'
    CreateJobRequest += '<Job Kind="Realtime" ServiceName="Z1yp1whm">'
    CreateJobRequest += '<SourceContentMap>'
    CreateJobRequest += '<SourceContent BinaryData="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wIOSwpx4j+ISN0oijJQS8pCmH6QobxQlAT8uBeytJMS0gpMjPJ4XMvBrFhJcQYupsG+aBezaL0ZJOS7GybhpnAa5eTKJ0XUzjfNA4zUMYyScl+M07DnMhBmKcRci+ncd5yHWeB5HCXEvx2nof50HmgTiLkX07j3Pw6zwQR4mScx2nwf6GIWfR5GUcpvHyfiHoQfaBOk5jdPZFzWyCR6ZQ4AnY0kIiwsBTqZTAbUWDNZgKARqFY4EwjCSVkpeLpcK5+amRymSl4vnCxGermUyVCTr0R8taZTIaRZG6uZaSoSdtx52jTgMQYmilJxoELPQSRo040CMTUlJxpwGeguak40oxNVTRpxZ6C5qTjSjE1VNGnFnoLypONKKTVs0acWWgvKk40oq1bNGnFlwvKk40oq1blGnFlwvNk40oq0NyjTiy4TEFNRTMuOTcuMVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7smS+j/VEaKwDTDNwAAANIAAAAQAAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuOTcuMVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVRBRwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/" File="" Path="" NASCode="" ID="0">'
    CreateJobRequest += '<Container ID="MP3">'
    CreateJobRequest += '<VideoCodec BitRate="" Height="" ID="" MaxFrameRate="" VariableFrameRate="" Width=""/>'
    CreateJobRequest += '<AudioCodec BitPerSample="" BitRate="" Channel="" ID="" SampleRate=""/>'
    CreateJobRequest += '</Container>'
    CreateJobRequest += '</SourceContent>'
    CreateJobRequest += '</SourceContentMap>'
    CreateJobRequest += '<TargetContentMap>'
    CreateJobRequest += '<TargetContent BinaryData="" File="" ID="8" NASCode="" Path="">'
    CreateJobRequest += '<Container ID="AMR">'
    CreateJobRequest += '<VideoCodec BitRate="" Height="" ID="" MaxFrameRate="" VariableFrameRate="" Width=""/>'
    CreateJobRequest += '<AudioCodec BitPerSample="16" BitRate="12200" Channel="1" ID="AMR" SampleRate="8000"/>'
    CreateJobRequest += '</Container>'
    CreateJobRequest += '</TargetContent>'
    CreateJobRequest += '</TargetContentMap>'
    CreateJobRequest += '<TranscodingList>'
    CreateJobRequest += '<Transcoding SourceContentID="0" TargetContentID="8"/>'
    CreateJobRequest += '</TranscodingList>'
    CreateJobRequest += '</Job>'
    CreateJobRequest += '</CreateJobRequest>'
    CreateJobRequest += '</BODY>'
    CreateJobRequest += '</WTRS.MSG>'
    
    TcpSendMsg(CreateJobRequest)
    lock.release()

def SendAliveCheck():
    global SHUTDOWN
    global lock
    global SessionID
    global SendAliveCheckTimer
    time.sleep(2)
    while not SHUTDOWN :
        lock.acquire()
        
        LinkTestRequest = '<?xml version="1.0"?>'
        LinkTestRequest += '<WTRS.MSG Version="1.0">'
        LinkTestRequest += '<HEADER From="urn:wtrsp:auth.endpoint:MMSC_ACPT" SessionID="%s" To="urn:wtrsp:system:wtrsg" TransactionID="%d">' % (SessionID, GetTid())
        LinkTestRequest += '<Error Code="" Description="" Source=""/>'
        LinkTestRequest += '</HEADER>'
        LinkTestRequest += '<BODY>'
        LinkTestRequest += '<LinkTestRequest/>'
        LinkTestRequest += '</BODY>'
        LinkTestRequest += '</WTRS.MSG>' 
        
        TcpSendMsg(LinkTestRequest)
        lock.release()
        time.sleep(SendAliveCheckTimer)

def RecvTcpData():
    global SHUTDOWN
    global SessionID
    while not SHUTDOWN :
        header = c.recv(30)
        bodySizeStr = header[10:]
        
        body = c.recv(int(bodySizeStr))
        recvLen = len(body)

        while recvLen < int(bodySizeStr) :
            contineRecv = (int(bodySizeStr) - recvLen)
            body += c.recv(abs(contineRecv))
            recvLen = int(len(body))
        
            print('byte[body size : %d/%d]' % (len(body), int(bodySizeStr)))
        else :
            print('byte[body size : %d/%d] ok' % (len(body), int(bodySizeStr)))
        
        try:
            decompress_msg = zlib.decompress(body)
        except Exception as e:
            continue
        decompress_msg = decompress_msg[0:-1]
        logger.info('[RECV]' + decompress_msg.decode('utf-8'))
        
        root = ET.fromstring(decompress_msg)

        body = root.find('BODY')
        if body.find('EstablishSessionResponse') is not None :
            header = root.find('HEADER')
            SessionID = header.attrib.get('SessionID')
        elif body.find('CloseSessionResponse') is not None :
            SHUTDOWN = True

if __name__ == "__main__":   
    
    logger = logging.getLogger()
    logger.setLevel(logging.DEBUG)
    
    formatter = logging.Formatter('%(asctime)s [%(levelname)s] - %(message)s')
    
    file_handler = logging.FileHandler('../../log/TRSE_CLIENT/trse_client_{:%m%d}.log'.format(datetime.datetime.now()))
    file_handler.setFormatter(formatter)
    logger.addHandler(file_handler)
    
    logger.info('create socket')
    c = socket(AF_INET, SOCK_STREAM)
    
    logger.info('connecting.. {host}:{port}'.format(host=HOST, port=PORT))
    
    c.connect((HOST, PORT))
    logger.info('connected')
    print(c.getblocking())
    print(c.gettimeout())
    SendEstablishSessionRequest()
    t1 = threading.Thread(target=SendAliveCheck, args=())
    t1.daemon = True
    t1.start()

    t2 = threading.Thread(target=RecvTcpData, args=())
    t2.daemon = True
    t2.start()

    while not SHUTDOWN :
        display_menu = '1. SendCloseSessionRequest\n'
        display_menu += '2. SendCreateJobRequest'
        print(display_menu)
        
        x = int(input('intput: '))
        print('')
        if x == 1 :
            SendCloseSessionRequest()
            time.sleep(1)
            continue
        elif x == 2 :
            SendCreateJobRequest()
        else :
            print('else')
            
    c.close()
    logger.info('end...')
    
    
